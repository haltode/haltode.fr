<!DOCTYPE html>
<html>
   <head>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato&#38;subset=latin,latin-ext" type="text/css" />
      <link rel="icon" type="image/x-icon" href="//static.napnac.ga/img/favicon.ico">
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/styles/github-gist.min.css">

      <!-- Syntax highlighting -->
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>

      <!-- Renders LaTeX expression -->
      <script type="text/x-mathjax-config">
         MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
      </script>
      <script type="text/javascript" async
         src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
      </script>

      <!-- CSS -->
<style>
body {
   font-family: "Helvetica Neue", 'Lato', Helvetica, sans-serif;
   max-width: 1000px;
   margin: 0 auto;
   position: relative;
   width: 95%;
   line-height: 1.5;
}

/* ---- Titles ---- */

h1 {
   padding-top: 2%;
   padding-bottom: 2%;
   color: #DE4834;
}

h2, h3, h4, h5, h6 {
   padding-top: 1%;
   padding-bottom: 1%;
   color: #DE4834;
}

/* ---- Link ---- */

a {
   text-decoration: none;
   color: #2E64FE;
}

/* ---- List (+ main menu list) ---- */

ul {
   padding-left: 30px;
}

#main_menu {
   list-style: none;
   margin: 0;
   padding: 0;
   text-align: center;
}
#main_menu li {
   display: inline;
   margin-right: 1px;
}
#main_menu li a {
   line-height: 1em;
   padding: 4px 20px;
   text-align: center;
}
#main_menu li a:hover, #main_menu li a:active {
   text-decoration: underline;
}

/* ---- Tables (same look as from github markdown layout) ---- */

table {
   display: block;
   width: 100%;
   overflow: auto;
   word-break: normal;
   word-break: keep-all;
   border-collapse: collapse;
   border-spacing: 0;
   margin-top: 0;
   margin-bottom: 16px;
}

table th {
   font-weight: bold;
}

table th,
table td {
   padding: 6px 13px;
   border: 1px solid #ddd;
}

table tr {
   background-color: #fff;
   border-top: 1px solid #ccc;
}

table tr:nth-child(2n) {
   background-color: #f8f8f8;
}

/* ---- Image and caption ---- */

.figure {
   text-align: center;
}

.caption {
   font-style: italic;
   text-align: center;
}

/* ---- Summary ---- */

#summary {
   width: 70%;
   text-align: justify;
   line-height: 1.6;
}

/* ---- Code ---- */
pre {
   width: 90%;
   white-space: pre-wrap;
   word-break: break-all;
   word-wrap: break-word;
}
</style>
      <!---- ---->

      <title>Chiffre de Vigen√®re - napnac</title>
   </head>

   <body>

      <!-- Javascript -->
<script type="text/javascript">
function toggle_visibility(id) {
   var element = document.getElementById(id);
   if(element.style.display == 'block')
      element.style.display = 'none';
   else
      element.style.display = 'block';
}
</script>
      <!---- ---->

      <header>
         <a href="/">
            <img src="//static.napnac.ga/img/logo.png" alt="Logo du site" height="100" width="300">
         </a>

      </header>

      <nav>
         <ul id="main_menu">
            <li><a href="/">Accueil</a></li>
            <li><a href="/articles.html">Articles</a></li>
            <li><a href="/projets.html">Projets</a></li>
            <li><a href="/a_propos.html">A propos</a></li>
         </ul>
      </nav>

      <!-- Page/Article -->

<a href=""><h1 id="chiffre-de-vigen&#232;re">Chiffre de Vigen&#232;re</h1></a>
<p>Publi&#233; le : 28/05/2014<br />
<em>Modifi&#233; le : 20/12/2015</em></p>
<ul id="summary">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#principe-de-lalgorithme">Principe de l'algorithme</a></li>
<li><a href="#exemple">Exemple</a></li>
<li><a href="#pseudo-code">Pseudo-code</a></li>
<li><a href="#impl&#233;mentation">Impl&#233;mentation</a></li>
<li><a href="#cassage">Cassage</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Avec l'apparition des premiers syst&#232;mes de cryptanalyses, le <a href="/algo/chiffrement/chiffre_cesar.html">chiffre de C&#233;sar</a> n'est plus un algorithme s&#251;r pour chiffrer ses messages, et on voit l'apparition d'un nouvel algorithme de chiffrement : <strong>le chiffre de Vigen&#232;re</strong>. Ce dernier est immunis&#233; aux attaques du chiffre de C&#233;sar, car sa cl&#233; est une cha&#238;ne de caract&#232;res et non plus un simple nombre, cependant quelques si&#232;cles apr&#232;s les premi&#232;res utilisations de ce syst&#232;me, des techniques permettant de casser le chiffre de Vigen&#232;re sont d&#233;couvertes le rendant alors vuln&#233;rable et inutile.</p>
<h2 id="principe-de-lalgorithme">Principe de l'algorithme</h2>
<p>Le chiffre de Vigen&#232;re est un <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">chiffrement sym&#233;trique</a> utilisant une <a href="https://en.wikipedia.org/wiki/Substitution_cipher#Polyalphabetic_substitution">substitution poly-alphab&#233;tique</a> pour chiffrer et d&#233;chiffrer le message secret. Ceci signifie que la cl&#233; de chiffrement est une cha&#238;ne de caract&#232;res, et c'est l&#224;-dessus que repose la s&#233;curit&#233; de l'algorithme, car une m&#234;me lettre ne sera alors pas forc&#233;ment chiffr&#233;e de la m&#234;me fa&#231;on (elle d&#233;pendra de sa place dans le message, mais aussi de la cl&#233; utilis&#233;e).</p>
<h2 id="exemple">Exemple</h2>
<p>Prenons comme message secret le mot &quot;Programmation&quot;, et comme cl&#233; de chiffrement &quot;Linux&quot;. La premi&#232;re &#233;tape &#224; faire est de rendre notre cl&#233; aussi longue que notre message &#224; chiffrer, pour cela, on r&#233;p&#232;te simplement autant de fois la cl&#233; que n&#233;cessaire :</p>
<div class="figure">
<img src="//static.napnac.ga/img/algo/chiffrement/chiffre_vigenere/exemple_cle_chiffrement.png" alt="Visualisation de la cl&#233; de chiffrement compl&#232;te" />
<p class="caption">Visualisation de la cl&#233; de chiffrement compl&#232;te</p>
</div>
<p>D&#233;sormais on peut chiffrer chaque lettre de notre message :</p>
<div class="figure">
<img src="//static.napnac.ga/img/algo/chiffrement/chiffre_vigenere/exemple_chiffrement.png" alt="Exemple de chiffrement" />
<p class="caption">Exemple de chiffrement</p>
</div>
<p>Le rang dans l'alphabet commence &#224; 0 (et non 1) car <span class="math inline">\(26 \mod 26 = 0\)</span>, il faut donc que la lettre A soit la lettre 0. A chaque tour, on prend le rang de la lettre du message, et on l'additionne &#224; la lettre correspondante de la cl&#233;. On n'oublie pas d'appliquer notre <a href="https://en.wikipedia.org/wiki/Modulo_operation">modulo</a> 26 pour revenir au d&#233;but de l'alphabet si on d&#233;passe Z.</p>
<p>Pour le d&#233;chiffrement, l'id&#233;e est la m&#234;me sauf qu'on soustrait au lieu d'ajouter le rang de la lettre de la cl&#233; :</p>
<div class="figure">
<img src="//static.napnac.ga/img/algo/chiffrement/chiffre_vigenere/exemple_dechiffrement.png" alt="Exemple de d&#233;chiffrement" />
<p class="caption">Exemple de d&#233;chiffrement</p>
</div>
<p>On peut utiliser cette m&#233;thode mais de mani&#232;re plus visuelle afin de chiffrer et d&#233;chiffrer nos messages :</p>
<div class="figure">
<img src="//static.napnac.ga/img/algo/chiffrement/chiffre_vigenere/table_vigenere.png" alt="Table de Vigen&#232;re" />
<p class="caption">Table de Vigen&#232;re</p>
</div>
<p>La <strong>table de Vigen&#232;re</strong> consiste &#224; &#233;num&#233;rer toutes les possibilit&#233;s de d&#233;calage lors du chiffrement et du d&#233;chiffrement. Les lettres du message clair sont repr&#233;sent&#233;es par les colonnes, tandis que celles de la cl&#233; sont repr&#233;sent&#233;es par les lignes. Pour chiffrer une lettre, on regarde l'intersection de la colonne correspondante &#224; la lettre du message clair, et de la ligne correspondante &#224; lettre de la cl&#233;. Pour d&#233;chiffrer une lettre, on regarde sur la ligne correspondante de la cl&#233; jusqu'&#224; trouver la lettre chiffr&#233;e qui se trouvera sur la colonne de la lettre d&#233;chiffr&#233;e.</p>
<h2 id="pseudo-code">Pseudo-code</h2>
<p>Le pseudo-code du chiffre de Vigen&#232;re :</p>
<pre class="nohighlight"><code>Modifier la cl&#233; pour qu&#39;elle soit de la m&#234;me taille que le message

chiffrer : 

   Pour chaque caract&#232;re du message
      Si c&#39;est une lettre
         D&#233;caler cette lettre de cle[iCle] rangs vers la droite
         Incrementer iCle

d&#233;chiffrer :

   Pour chaque caract&#232;re du message
      Si c&#39;est une lettre
         D&#233;caler cette lettre de cle[iCle] rangs vers la gauche 
         Incrementer iCle</code></pre>
<h2 id="impl&#233;mentation">Impl&#233;mentation</h2>
<p>Une impl&#233;mentation en C du chiffre de Vigen&#232;re :</p>
<a href="javascript:toggle_visibility('chiffre_vigenere.c');">chiffre_vigenere.c</a>
<div id="chiffre_vigenere.c" style="display: none;">
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="ot">#include &lt;stdio.h&gt;</span>
<span class="ot">#include &lt;ctype.h&gt;</span>
<span class="ot">#include &lt;string.h&gt;</span>

<span class="ot">#define TAILLE_MAX 10000</span>

<span class="dt">char</span> message[TAILLE_MAX];
<span class="dt">char</span> cle[TAILLE_MAX];
<span class="dt">int</span> tailleCle;

<span class="dt">void</span> chiffrement(<span class="dt">void</span>)
{
   <span class="dt">int</span> iTab, iCle;

   <span class="kw">for</span>(iTab = <span class="dv">0</span>, iCle = <span class="dv">0</span>; message[iTab] != &#39;\<span class="dv">0</span>&#39;; ++iTab) {
      <span class="kw">if</span>(isalpha(message[iTab])) {
         <span class="dt">char</span> typo, lettreCle;
         typo = (isupper(message[iTab])) ? &#39;A&#39; : &#39;a&#39;;
         lettreCle = tolower(cle[iCle]) - &#39;a&#39;;
         iCle = (iCle + <span class="dv">1</span>) % tailleCle;

         message[iTab] -= typo;
         message[iTab] = ((message[iTab] + lettreCle) % <span class="dv">26</span> + <span class="dv">26</span>) % <span class="dv">26</span>;
         message[iTab] += typo;
      }
   }
}

<span class="dt">void</span> dechiffrement(<span class="dt">void</span>)
{
   <span class="dt">int</span> iTab, iCle;

   <span class="kw">for</span>(iTab = <span class="dv">0</span>, iCle = <span class="dv">0</span>; message[iTab] != &#39;\<span class="dv">0</span>&#39;; ++iTab) {
      <span class="kw">if</span>(isalpha(message[iTab])) {
         <span class="dt">char</span> typo, lettreCle;
         typo = (isupper(message[iTab])) ? &#39;A&#39; : &#39;a&#39;;
         lettreCle = tolower(cle[iCle]) - &#39;a&#39;;
         iCle = (iCle + <span class="dv">1</span>) % tailleCle;

         message[iTab] -= typo;
         message[iTab] = ((message[iTab] - lettreCle) % <span class="dv">26</span> + <span class="dv">26</span>) % <span class="dv">26</span>;
         message[iTab] += typo;
      }
   }
}

<span class="dt">void</span> viderBuffer(<span class="dt">void</span>)
{
   <span class="dt">int</span> c;
   c = <span class="dv">0</span>;
   <span class="kw">while</span>(c != <span class="ch">&#39;\n&#39;</span> &amp;&amp; c != EOF)
      c = getchar();
}

<span class="dt">int</span> main(<span class="dt">void</span>)
{
   scanf(<span class="st">&quot;%[^</span><span class="ch">\n</span><span class="st">]s</span><span class="ch">\n</span><span class="st">&quot;</span>, message);
   viderBuffer();
   scanf(<span class="st">&quot;%[^</span><span class="ch">\n</span><span class="st">]s</span><span class="ch">\n</span><span class="st">&quot;</span>, cle);
   tailleCle = strlen(cle);

   chiffrement();
   printf(<span class="st">&quot;%s</span><span class="ch">\n</span><span class="st">&quot;</span>, message);
   dechiffrement();
   printf(<span class="st">&quot;%s</span><span class="ch">\n</span><span class="st">&quot;</span>, message);

   <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre></div>
</div>
<p>Notez qu'au lieu de cr&#233;er une seconde cl&#233; de chiffrement de la taille du message, on peut tout simplement utiliser un indice que l'on r&#233;initialise &#224; 0 &#224; chaque fois qu'il a atteint le bout de la cl&#233; (gr&#226;ce &#224; <code>% tailleCle</code>).</p>
<p>Notre message et notre cl&#233; :</p>
<pre class="nohighlight"><code>Programmation
Linux</code></pre>
<p>Le chiffrement et le d&#233;chiffrement :</p>
<pre class="nohighlight"><code>Azbaoluzuqtwa
Programmation</code></pre>
<h2 id="cassage">Cassage</h2>
<p>Les <a href="/algo/chiffrement/chiffre_cesar.html#cassage">attaques du chiffre de C&#233;sar</a> ne fonctionnent pas sur le chiffre de Vigen&#232;re pour plusieurs raisons :</p>
<ul>
<li>La cl&#233; est une cha&#238;ne de caract&#232;res de taille variable, ce qui signifie que le nombre de possibilit&#233;s de cl&#233;s de chiffrement est &#233;norme, et une attaque par force brute n'est tout simplement pas envisageable.</li>
<li>L'algorithme utilise une substitution poly-alphab&#233;tique, rendant ainsi une analyse fr&#233;quentielle impossible car une lettre ne sera pas forc&#233;ment chiffr&#233;e de la m&#234;me mani&#232;re dans un texte.</li>
</ul>
<p>Il nous faut donc de nouvelles m&#233;thodes, afin de casser cet algorithme r&#233;put&#233; incassable jusqu'&#224; la fin du XIXe si&#232;cle o&#249; une m&#233;thode fut officiellement d&#233;couverte.</p>
<p>Notre objectif est de casser le message ci-dessus qui a &#233;t&#233; chiffr&#233; en utilisant le chiffre de Vigen&#232;re :</p>
<pre class="nohighlight"><code>wmfwepnfkrtlrjrtaqykzuolbfarmxyvrypdwanxwigyqplrmxcurypqznhzlqfypzvgzlcurokrwhpbcvrgbybpydzciyoymzykeiyfbrcnhqwiqyclqgyapvbmxcurypdmfnjtarholxcioeiiyzwmahbxqcirckrmppzyyzzuouqnmenbdvbopldbhppbrhlfafijxmfmrmurldpacuowisionmzyzlvvkrpbrlopaglbpbnyotmahbomyykymzcfynvhfxmanmwcfkrptrooywzvopkrmlybyypnpnlpwmfustwamilbnwqtyhyapanfipunhadyhckzcfzlybeyzftrlzpabhqwmfwelzffbdiiclyayuqlkgcnfmqypltyyjlvqmnfqbhqdcejotaaipnprzplccifybqyipangbymefxzcvfppvfikeihdlfzqbrtuncpwmqyoyqrljzbrmqttqcqwmfjbciawbowvnbwtrxfdxnlxdbeyillrzxtbrypemyfbomscktbvpbywawozgrtjzqzifbcvplfacuowmrhzzvaufdanhzplrwxfaryqgwhmatadobcqrhkpagjbclhjlfzyucciawbwmfgbxmfgljmamnfqairdwanslqawrdxrospvgzxtzrpbyqeokuwhlildvwqzqeyzlzyucciawbymfnmlafyrwmrfipvrmqaifmbftryiwmaypexnmppcyybwtrurydnmqpmzjfcmqyocqrlbptyybwtrjbfbsufcmoflniiyzwmzjfcmolfeiahfbcrkrtbvyketngbcmgwlybvhrptnfrebryiwmcyrekbgjptnhdwmgyocmhnfwqfyodiamituvnbdtvgjpvfyfylhmqcqrxbdmguqdcacpnmgnbrcrlopvrmqaifffxqgyblcgyocqgifcmzuismhlbffqykzbeymlgfwbebrarpzeykpagjxdbeuknprymlzyuylbnciwmqycciawbnmgnbrcrlopmfnrymtobczrglylvuipbboqpayypqihnbdbbopwmflbeiexpewhnbdtrmpzcszolvpypymzjbnprhqaifkrttlualvffryqiyodbbopwmfgljmamkpkrmplqeypawhlbnznmbccadlfzaippvayjtasirozbsbdihdlfzqbrtxnlilnblzpurwxyqdobywhmmzcellyaiufykeyalvffxgmacoaieokpnblzpurwxyqdobdccyotmhlbwmqypeqaxrxwaxbpagfxxwvabymeuiomturwtruzecrfipurhqltbhacmfdfydvnbwmficqqpcbcarnipafiioigmcciawxtadofdmgllfdrhqpvgyocqgifcmolfeiahfbcrirbcvpfpvqlxtmanxdggllfdrlxgmpfbfzfuoxmfirdiamipcemxcurmgtvicqptrmfyorhfpcembetrmlfdecbcafjbnqnffdbrmapavhafaglfpaquoxmzykeyhcppbeirgmanbybrlotbbcopjecqlvacnfmbonfqicbyleufpvgupjbeirgmeuppurnqcmrholxcioeiiyzxwvkrzqdofwielfgmyucwizgbomyuopavmqlvpycciawxtarhbowvnmlafyqpqaxopmghbdmgyfyleumlaqyjlqawlxururuwhlascvdbaiefbcivuilznxfzlrflyleyp</code></pre>
<p>Les seules informations que l'on a sont que toutes les majuscules ont &#233;t&#233; transform&#233;es en minuscules, tous les accents par des lettres non accentu&#233;es, et les espaces et signes de ponctuations ont &#233;t&#233; enlev&#233;s.</p>
<h3 id="trouver-la-longueur-de-la-cl&#233;-de-chiffrement">Trouver la longueur de la cl&#233; de chiffrement</h3>
<p>Pour casser le chiffre de Vigen&#232;re, il faut proc&#233;der par &#233;tape, et la premi&#232;re est de d&#233;terminer la longueur de la cl&#233; de chiffrement employ&#233;e pour chiffrer le message. Une fois cette longueur connue, on peut savoir quelles lettres sont chiffr&#233;es avec la m&#234;me portion de cl&#233;, rendant alors la cryptanalyse du message bien plus facile.</p>
<p>Un des moyens de trouver la longueur de cl&#233; est d'utiliser le <strong>test de Kasiski</strong>. Le but est de rep&#233;rer dans le message chiffr&#233; des sous cha&#238;nes qui se r&#233;p&#232;tent, car ces derni&#232;res sont sans doute des m&#234;mes portions du texte clair, cod&#233;es avec la m&#234;me partie de cl&#233;. Une fois qu'on connait suffisamment de r&#233;p&#233;titions, on peut gr&#226;ce &#224; l'espacement de ces derni&#232;res en d&#233;duire les tailles de cl&#233;s possibles et en combinant plusieurs analyses on peut voir qu'une taille ressortira plus souvent que les autres. Mais pour cela notre texte doit &#234;tre suffisamment long afin d'avoir un traitement efficace des sous cha&#238;nes (notre m&#233;thode &#233;tant bas&#233;e sur des statistiques, si on a peu de donn&#233;es notre r&#233;sultat ne sera pas forc&#233;ment correcte et repr&#233;sentatif de la r&#233;alit&#233;). Heureusement, notre texte semble assez long et contient environ 1000 sous chaines se r&#233;p&#233;tant (de diff&#233;rentes tailles allant de trois caract&#232;res &#224; quatorze), et en voici une courte partie :</p>
<table>
<thead>
<tr class="header">
<th align="left">Chaine</th>
<th align="left">Ecart</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
<th align="center">8</th>
<th align="center">9</th>
<th align="center">10</th>
<th align="left">...</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">far</td>
<td align="left">555</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">rmx</td>
<td align="left">20</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">ryp</td>
<td align="left">20</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">ypd</td>
<td align="left">95</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">dwa</td>
<td align="left">605</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">wan</td>
<td align="left">605</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">anx</td>
<td align="left">1385</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">yqp</td>
<td align="left">1630</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">plr</td>
<td align="left">530</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">mxc</td>
<td align="left">75</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">xcu</td>
<td align="left">75</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">cur</td>
<td align="left">20</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">ury</td>
<td align="left">75</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">ryp</td>
<td align="left">75</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">ypq</td>
<td align="left">1000</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">yzwm</td>
<td align="left">640</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">mahb</td>
<td align="left">95</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">krmp</td>
<td align="left">980</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">mnfq</td>
<td align="left">240</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">byme</td>
<td align="left">870</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">eiiyz</td>
<td align="left">1465</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">iiyzw</td>
<td align="left">640</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">iyzwm</td>
<td align="left">640</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">acuow</td>
<td align="left">345</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">ihdlf</td>
<td align="left">740</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">gifcm</td>
<td align="left">450</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">yccia</td>
<td align="left">645</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">cciaw</td>
<td align="left">355</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">dbbop</td>
<td align="left">65</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">mxcuryp</td>
<td align="left">75</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">rholxci</td>
<td align="left">1465</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">purwxyqdo</td>
<td align="left">50</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">rholxcioei</td>
<td align="left">1465</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">ihdlfzqbrt</td>
<td align="left">740</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">fcmolfeiah</td>
<td align="left">600</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="center"></td>
<td align="center">X</td>
<td align="left">...</td>
</tr>
<tr class="even">
<td align="left">...</td>
<td align="left">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="center">...</td>
<td align="left">...</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="left"></td>
<td align="center">537</td>
<td align="center">371</td>
<td align="center">268</td>
<td align="center"><strong>916</strong></td>
<td align="center">215</td>
<td align="center">101</td>
<td align="center">174</td>
<td align="center">71</td>
<td align="center">528</td>
<td align="left">...</td>
</tr>
</tbody>
</table>
<p>Pour chaque sous chaine, on note l'&#233;cart jusqu'&#224; la prochaine occurrence de ladite chaine, puis on peut en d&#233;duire que la taille de notre cl&#233; est un multiple de cet espace (en effet, il y a une r&#233;p&#233;tition en g&#233;n&#233;ral quand une m&#234;me portion du message est chiffr&#233;e avec une m&#234;me portion de la cl&#233;). On marque alors pour chaque sous chaine les diviseurs de notre &#233;cart, et lorsqu'on additionne tous les r&#233;sultats on voit que le nombre 5 est celui qui apparait le plus de fois. Ce test nous apprend donc que la cl&#233; de chiffrement que l'on cherche a de tr&#232;s fortes chances de poss&#233;der 5 caract&#232;res.</p>
<p>Une impl&#233;mentation en C du test de Kasiski :</p>
<a href="javascript:toggle_visibility('test_kasiski.c');">test_kasiski.c</a>
<div id="test_kasiski.c" style="display: none;">
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="ot">#include &lt;stdio.h&gt;</span>
<span class="ot">#include &lt;ctype.h&gt;</span>
<span class="ot">#include &lt;stdbool.h&gt;</span>
<span class="ot">#include &lt;string.h&gt;</span>

<span class="ot">#define TAILLE_MAX 10000</span>
<span class="ot">#define NB_POSSIBILITE_MAX 10000</span>

<span class="dt">char</span> message[TAILLE_MAX];
<span class="dt">int</span> tailleMessage;

<span class="dt">int</span> nbPossibilite[NB_POSSIBILITE_MAX];
<span class="dt">int</span> possibiliteMax;

<span class="dt">int</span> chercherOccurrence(<span class="dt">char</span> chaine[], <span class="dt">int</span> taille, <span class="dt">int</span> debut)
{
   <span class="dt">int</span> iDebut;

   <span class="kw">for</span>(iDebut = debut; iDebut &lt; tailleMessage - taille + <span class="dv">1</span>; ++iDebut) {
      <span class="dt">int</span> iTab, iChaine;

      iTab = iDebut;
      iChaine = <span class="dv">0</span>;
      <span class="kw">while</span>(iTab &lt; tailleMessage - taille + <span class="dv">1</span> &amp;&amp;
            chaine[iChaine] == message[iTab]) {
         ++iTab;
         ++iChaine;
      }

      <span class="kw">if</span>(iChaine == taille)
         <span class="kw">return</span> iDebut;
   }

   <span class="kw">return</span> -<span class="dv">1</span>;
}

<span class="dt">void</span> ajouterTaillePossible(<span class="dt">int</span> ecart)
{
   <span class="dt">int</span> iDiv;

   <span class="kw">for</span>(iDiv = <span class="dv">2</span>; iDiv &lt;= ecart; ++iDiv) {
      <span class="kw">if</span>(ecart % iDiv == <span class="dv">0</span>) {
         ++nbPossibilite[iDiv];
         <span class="kw">if</span>(nbPossibilite[iDiv] &gt; nbPossibilite[possibiliteMax])
            possibiliteMax = iDiv;
      }
   }
}

<span class="dt">void</span> testKasiski(<span class="dt">void</span>)
{
   <span class="dt">int</span> iTaille, iDebut;
   bool trouve;

   iTaille = <span class="dv">3</span>;
   trouve = true;

   <span class="kw">while</span>(trouve) {
      trouve = false;

      <span class="kw">for</span>(iDebut = <span class="dv">0</span>; iDebut &lt; tailleMessage - iTaille + <span class="dv">1</span>; ++iDebut) {
         <span class="dt">char</span> chaine[iTaille + <span class="dv">1</span>];
         <span class="dt">int</span> iTab;
         <span class="dt">int</span> occurrence;

         <span class="kw">for</span>(iTab = <span class="dv">0</span>; iTab &lt; iTaille; ++iTab)
            chaine[iTab] = message[iDebut + iTab];
         chaine[iTab] = &#39;\<span class="dv">0</span>&#39;;

         occurrence = chercherOccurrence(chaine, iTaille, iDebut + iTaille);
         <span class="kw">if</span>(occurrence != -<span class="dv">1</span>) {
            <span class="dt">int</span> ecart;

            ecart =  occurrence - iDebut;
            trouve = true;

            <span class="co">//printf(&quot;%s %d\n&quot;, chaine, ecart);</span>

            ajouterTaillePossible(ecart);
         }
      }

      ++iTaille;
   }
}

<span class="dt">int</span> main(<span class="dt">void</span>)
{
   scanf(<span class="st">&quot;%s</span><span class="ch">\n</span><span class="st">&quot;</span>, message);
   tailleMessage = strlen(message);

   possibiliteMax = <span class="dv">0</span>;
   testKasiski();

   <span class="co">/*int iDiv;</span>
<span class="co">   for(iDiv = 0; iDiv &lt; NB_POSSIBILITE_MAX; ++iDiv)</span>
<span class="co">      if(nbPossibilite[iDiv] != 0)</span>
<span class="co">         printf(&quot;%d : %d\n&quot;, iDiv, nbPossibilite[iDiv]);*/</span>

   printf(<span class="st">&quot;%d</span><span class="ch">\n</span><span class="st">&quot;</span>, possibiliteMax);

   <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre></div>
</div>
<p>Tout d'abord, on commence &#224; chercher des sous chaines d'une taille de trois caract&#232;res minimum car les sous chaines de deux caract&#232;res ne sont pas r&#233;ellement efficaces et repr&#233;sentatives (&#231;a peut simplement &#234;tre un coup de chance). Ensuite, la recherche de sous chaine n'est pas optimis&#233;e car le but de cette impl&#233;mentation est de montrer comment appliquer le test de Kasiski. Si vous voulez casser un texte plus important, je vous conseille de revoir la recherche de sous chaine en vous aidant d'algorithmes plus efficaces comme <a href="https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm">KMP</a>, <a href="https://en.wikipedia.org/wiki/Rabin%E2%80%93Karp_algorithm">Rabin-Karp</a>, ou encore <a href="http://codeforces.com/blog/entry/3107">Z</a>. Le code s'ex&#233;cute instantan&#233;ment dans notre exemple, mais sur des textes aussi grands que des livres, il risque de prendre plus de temps s'il n'est pas optimis&#233;.</p>
<p>La sortie de l'impl&#233;mentation (j'ai comment&#233; l'affichage des sous chaines/&#233;cart, et celui du tableau des possibilit&#233;s car sinon plus de 1000 lignes sont affich&#233;es en sortie) :</p>
<pre class="nohighlight"><code>5</code></pre>
<h3 id="d&#233;duire-la-cl&#233;">D&#233;duire la cl&#233;</h3>
<p>Une fois qu'on a notre longueur de cl&#233;, on peut savoir quelles lettres du message ont &#233;t&#233; chiffr&#233;es avec les m&#234;mes lettres de la cl&#233; (puisqu'on connait sa longueur, on sait donc o&#249; se r&#233;p&#232;te la cl&#233;).</p>
<p>On va alors d&#233;couper le message chiffr&#233; en plusieurs cat&#233;gories de lettres :</p>
<ul>
<li>Celles chiffr&#233;es avec la 1&#232;re lettre de la cl&#233; (soit la 1&#232;re, la 6&#232;me, la 11&#232;me, etc.)</li>
<li>Celles chiffr&#233;es avec la 2&#232;me lettre de la cl&#233; (soit la 2&#232;me, la 7&#232;me, la 12&#232;me, etc.)</li>
<li>...</li>
<li>Celles chiffr&#233;es avec la 5&#232;me lettre de la cl&#233; (soit la 5&#232;me, la 10&#232;me, la 15&#232;me, etc.)</li>
</ul>
<p>Notre message d&#233;coup&#233; en 5 lignes :</p>
<pre class="nohighlight"><code>1 : wpttzfydwpcqlzcrcyzyerwlpcdtlewxcpzndlpfxmpwnlppptoyyxwpypynwtltppdzyfpwldylfllfdtnlypyzpeftwyztwcowddlteotyzzbfwzdpfgtcpcfcwxjfdldptyulzlcylwpafwepwypccpwfcnwcebtecypewepwcwdtdpycddnrpaxlccsfzleppdnllwcnrpycyppqdweedzlynatlydwjplancfptodftlpyyzyylgappydtwexpxyoweplcywqcpoctdfpccebbptdfgfxdpctpypefcndpfpxepgytplffypjgpclexzwgwoplctolppdyllxusaclzy
2 : mnlauavwiluzqvuwvbcmiciqvumaximqkzumvdbamuaimvbabmmmnmctwkbpmwbyauycbtamziakmtvqcapcbamcvizumqbtmiwtxblbmmbwgqcamvalawaqalzimmmqwqxvzqwdqzimamvitmxctdmmqttbmimmicbtmbtbmktmmqiutvlqmcmcviqcqmmfbgbzabpzbmimcmmzlbaibmiwtcvmpitvqbmmkqwzczvazizxnuqwcakvminuqcmmqwawmmtcutmdmqaaiiamdvqmiccvmgdmzmicuvtoctdaqbaaamybmbbjvmqlvbmumxiwqimimaviawaqmmlaquwciizll
3 : ffrqorragrrnfgrhrpizynqgbrfrciacryoebbrffrcszvrgnayzvafrzrynfanhnnhferbffiygqyqbearcqnevfhqnqrrqfavrnerrysvarzvcranrrhdrghyaffaaaargrehveyaffrrfranyrnzqryrsoizoarvngvnrcbnghfavvfhrgagrrfgggzhqefregerynqagrftrvbyhbfehrspzrflfibfarehnaaasbhqnbrdheiefaebrdchqaagvetrrrbfvfprfgadgrggoarvqagrpffaerirrerefnrvgqzhearbeabiegeerrcivdeyzyvparvfaggeqarhvevnre
4 : wkjylmynymyhyzopgyyyfhyymynhiyhimyunohhimluiykllyhychnkovmylumwyfhczylhwfcucyymhjiziygffidbcylmcjwnxlyzyfcpwtipuhuhwymohjjuwggminwozpolwyuwnyfmmyymyumjylyjufyjlhkygwhfyyghynymngymxucnlmfyyiulyywayjuyucywnlnoguoynolxnmzyjhkufyogmmylmdiyisdbllwomluyfcolwoylyxxfauuufhhdnicnimwolhyilhiplnllfuimmmcmhmmcjfmhluycinlcccocuuiunhiykolugumywhnyxhyuywuldfuxfy
5 : errkbxpxqxpzplkbbdokbqcaxpjoozbrpzqbppljrdoozrobobkffmroolppsiqaiaklzzqeblqnpjnqoppfibxpklrpojqqbbbfxixpbkbojflozfzxqabkblcbblnrsrsxbkiqzcbmriqbippbrqfobbbflzfffrkblrrirjdofoibjfqbqpboqfbofibkmbrkxkmyicbborbliqpbpbpbpopbqraroplkppbblpjrblrizxbmlfaxokzxbobprbxbirziqafbcbiicxflqofffrfxxlxborixgqffblbbfaafokprbooqnnbfprpqoozrffcboqcxbmqobfmjlrabbiflp</code></pre>
<p>Finalement, on peut dire que chaque ligne a &#233;t&#233; chiffr&#233;e &#224; l'aide d'un simple chiffre de C&#233;sar, puisque toutes les lettres d'une m&#234;me ligne sont chiffr&#233;es avec la m&#234;me lettre de la cl&#233;, et cette lettre peut &#234;tre vue comme un simple nombre. Une fois que l'on sait cela, on peut effectuer une analyse fr&#233;quentielle pour trouver la cl&#233; de chiffrement, comme pour le chiffre de C&#233;sar, sur chacune des lignes d&#233;coup&#233;es.</p>
<p>On cherche pour chaque ligne, la lettre apparaissant le plus, puis l'on d&#233;duit que cette lettre repr&#233;sente la lettre E dans l'alphabet normal, on peut donc facilement retrouver l'alphabet chiffr&#233; utilis&#233; avec cette lettre. Prenons l'exemple de la premi&#232;re ligne :</p>
<pre class="nohighlight"><code>1 : wpttzfydwpcqlzcrcyzyerwlpcdtlewxcpzndlpfxmpwnlppptoyyxwpypynwtltppdzyfpwldylfllfdtnlypyzpeftwyztwcowddlteotyzzbfwzdpfgtcpcfcwxjfdldptyulzlcylwpafwepwypccpwfcnwcebtecypewepwcwdtdpycddnrpaxlccsfzleppdnllwcnrpycyppqdweedzlynatlydwjplancfptodftlpyyzyylgappydtwexpxyoweplcywqcpoctdfpccebbptdfgfxdpctpypefcndpfpxepgytplffypjgpclexzwgwoplctolppdyllxusaclzy</code></pre>
<p>La lettre la plus utilis&#233;e ici est le P, on peut donc faire une correspondance entre l'alphabet normal et l'alphabet chiffr&#233;, nous permettant de trouver la premi&#232;re lettre de la cl&#233; de chiffrement, le L :</p>
<div class="figure">
<img src="//static.napnac.ga/img/algo/chiffrement/chiffre_vigenere/exemple_ligne.png" alt="Exemple de correspondance" />
<p class="caption">Exemple de correspondance</p>
</div>
<p>Si on applique ce principe &#224; chacune de nos lignes on obtient :</p>
<div class="figure">
<img src="//static.napnac.ga/img/algo/chiffrement/chiffre_vigenere/exemple_trouver_cle.png" alt="Recherche de cl&#233; de chiffrement" />
<p class="caption">Recherche de cl&#233; de chiffrement</p>
</div>
<p>La cl&#233; apparait alors &#224; la verticale en lisant simplement la correspondance de la lettre A dans chaque alphabet chiffr&#233;. En effet la lettre A repr&#233;sente la lettre 0 de l'alphabet et donc la correspondance repr&#233;sente le d&#233;calage utilis&#233; (c'est-&#224;-dire la cl&#233;) pour cr&#233;er l'alphabet chiffr&#233;.</p>
<p>L'impl&#233;mentation en C de l'analyse fr&#233;quentielle :</p>
<a href="javascript:toggle_visibility('trouver_cle.c');">trouver_cle.c</a>
<div id="trouver_cle.c" style="display: none;">
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="ot">#include &lt;stdio.h&gt;</span>

<span class="ot">#define TAILLE_MAX 10000</span>
<span class="ot">#define LONG_CLE_MAX 100</span>

<span class="dt">char</span> message[TAILLE_MAX];
<span class="dt">int</span> longueurCle;

<span class="dt">char</span> decoupe[LONG_CLE_MAX][TAILLE_MAX];
<span class="dt">int</span> iDecoupe[LONG_CLE_MAX];

<span class="dt">int</span> frequence[LONG_CLE_MAX][<span class="dv">26</span>];
<span class="dt">int</span> frequenceMax[LONG_CLE_MAX];

<span class="dt">char</span> cle[LONG_CLE_MAX];

<span class="dt">void</span> decouperMessage(<span class="dt">void</span>)
{
   <span class="dt">int</span> iTab, iLettre, iCle;

   <span class="kw">for</span>(iTab = <span class="dv">0</span>; message[iTab] != &#39;\<span class="dv">0</span>&#39;; ++iTab) {
      iLettre = iTab % longueurCle;
      decoupe[iLettre][iDecoupe[iLettre]] = message[iTab];
      ++iDecoupe[iLettre];
   }

   <span class="kw">for</span>(iCle = <span class="dv">0</span>; iCle &lt; longueurCle; ++iCle) {
      printf(<span class="st">&quot;%d : &quot;</span>, iCle + <span class="dv">1</span>);
      <span class="kw">for</span>(iTab = <span class="dv">0</span>; iTab &lt; iDecoupe[iCle]; ++iTab)
         printf(<span class="st">&quot;%c&quot;</span>, decoupe[iCle][iTab]);
      printf(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
   }

   printf(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
}

<span class="dt">void</span> analyseFreq(<span class="dt">void</span>)
{
   <span class="dt">int</span> iCle, iTab, iLettre;

   <span class="kw">for</span>(iCle = <span class="dv">0</span>; iCle &lt; longueurCle; ++iCle) {
      <span class="kw">for</span>(iTab = <span class="dv">0</span>; iTab &lt; iDecoupe[iCle]; ++iTab) {
         iLettre = decoupe[iCle][iTab] - &#39;a&#39;;

         ++frequence[iCle][iLettre];
         <span class="kw">if</span>(frequence[iCle][iLettre] &gt; frequence[iCle][frequenceMax[iCle]])
            frequenceMax[iCle] = iLettre;
      }
   }

   <span class="kw">for</span>(iCle = <span class="dv">0</span>; iCle &lt; longueurCle; ++iCle)
      printf(<span class="st">&quot;%d : %c</span><span class="ch">\n</span><span class="st">&quot;</span>, iCle + <span class="dv">1</span>, frequenceMax[iCle] + &#39;a&#39;);

   printf(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);
}

<span class="dt">void</span> deduireCle(<span class="dt">void</span>)
{
   <span class="dt">int</span> iCle;

   <span class="kw">for</span>(iCle = <span class="dv">0</span>; iCle &lt; longueurCle; ++iCle) {
      cle[iCle] = (frequenceMax[iCle] + &#39;a&#39;) - (&#39;e&#39; - &#39;a&#39;);
      <span class="kw">if</span>(cle[iCle] &lt; &#39;a&#39;)
         cle[iCle] += <span class="dv">26</span>;
   }

   cle[iCle] = &#39;\<span class="dv">0</span>&#39;;
}

<span class="dt">int</span> main(<span class="dt">void</span>)
{
   scanf(<span class="st">&quot;%s</span><span class="ch">\n</span><span class="st">&quot;</span>, message);
   scanf(<span class="st">&quot;%d</span><span class="ch">\n</span><span class="st">&quot;</span>, &amp;longueurCle);

   decouperMessage();
   analyseFreq();
   deduireCle();

   printf(<span class="st">&quot;%s</span><span class="ch">\n</span><span class="st">&quot;</span>, cle);

   <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre></div>
</div>
<p>Le programme prend en entr&#233;e le message chiffr&#233; et la longueur de cl&#233; pr&#233;c&#233;demment trouv&#233;e, et retourne en sortie la d&#233;coupe du message, les lettres les plus utilis&#233;es pour chaque ligne, et la cl&#233; de chiffrement :</p>
<pre class="nohighlight"><code>1 : wpttzfydwpcqlzcrcyzyerwlpcdtlewxcpzndlpfxmpwnlppptoyyxwpypynwtltppdzyfpwldylfllfdtnlypyzpeftwyztwcowddlteotyzzbfwzdpfgtcpcfcwxjfdldptyulzlcylwpafwepwypccpwfcnwcebtecypewepwcwdtdpycddnrpaxlccsfzleppdnllwcnrpycyppqdweedzlynatlydwjplancfptodftlpyyzyylgappydtwexpxyoweplcywqcpoctdfpccebbptdfgfxdpctpypefcndpfpxepgytplffypjgpclexzwgwoplctolppdyllxusaclzy
2 : mnlauavwiluzqvuwvbcmiciqvumaximqkzumvdbamuaimvbabmmmnmctwkbpmwbyauycbtamziakmtvqcapcbamcvizumqbtmiwtxblbmmbwgqcamvalawaqalzimmmqwqxvzqwdqzimamvitmxctdmmqttbmimmicbtmbtbmktmmqiutvlqmcmcviqcqmmfbgbzabpzbmimcmmzlbaibmiwtcvmpitvqbmmkqwzczvazizxnuqwcakvminuqcmmqwawmmtcutmdmqaaiiamdvqmiccvmgdmzmicuvtoctdaqbaaamybmbbjvmqlvbmumxiwqimimaviawaqmmlaquwciizll
3 : ffrqorragrrnfgrhrpizynqgbrfrciacryoebbrffrcszvrgnayzvafrzrynfanhnnhferbffiygqyqbearcqnevfhqnqrrqfavrnerrysvarzvcranrrhdrghyaffaaaargrehveyaffrrfranyrnzqryrsoizoarvngvnrcbnghfavvfhrgagrrfgggzhqefregerynqagrftrvbyhbfehrspzrflfibfarehnaaasbhqnbrdheiefaebrdchqaagvetrrrbfvfprfgadgrggoarvqagrpffaerirrerefnrvgqzhearbeabiegeerrcivdeyzyvparvfaggeqarhvevnre
4 : wkjylmynymyhyzopgyyyfhyymynhiyhimyunohhimluiykllyhychnkovmylumwyfhczylhwfcucyymhjiziygffidbcylmcjwnxlyzyfcpwtipuhuhwymohjjuwggminwozpolwyuwnyfmmyymyumjylyjufyjlhkygwhfyyghynymngymxucnlmfyyiulyywayjuyucywnlnoguoynolxnmzyjhkufyogmmylmdiyisdbllwomluyfcolwoylyxxfauuufhhdnicnimwolhyilhiplnllfuimmmcmhmmcjfmhluycinlcccocuuiunhiykolugumywhnyxhyuywuldfuxfy
5 : errkbxpxqxpzplkbbdokbqcaxpjoozbrpzqbppljrdoozrobobkffmroolppsiqaiaklzzqeblqnpjnqoppfibxpklrpojqqbbbfxixpbkbojflozfzxqabkblcbblnrsrsxbkiqzcbmriqbippbrqfobbbflzfffrkblrrirjdofoibjfqbqpboqfbofibkmbrkxkmyicbborbliqpbpbpbpopbqraroplkppbblpjrblrizxbmlfaxokzxbobprbxbirziqafbcbiicxflqofffrfxxlxborixgqffblbbfaafokprbooqnnbfprpqoozrffcboqcxbmqobfmjlrabbiflp

1 : p
2 : m
3 : r
4 : y
5 : b

linux</code></pre>
<h3 id="d&#233;chiffrer-le-message">D&#233;chiffrer le message</h3>
<p>D&#233;sormais, on connait la cl&#233; de chiffrement que l'auteur du message a employ&#233;e pour chiffrer ce texte :</p>
<pre class="nohighlight"><code>wmfwepnfkrtlrjrtaqykzuolbfarmxyvrypdwanxwigyqplrmxcurypqznhzlqfypzvgzlcurokrwhpbcvrgbybpydzciyoymzykeiyfbrcnhqwiqyclqgyapvbmxcurypdmfnjtarholxcioeiiyzwmahbxqcirckrmppzyyzzuouqnmenbdvbopldbhppbrhlfafijxmfmrmurldpacuowisionmzyzlvvkrpbrlopaglbpbnyotmahbomyykymzcfynvhfxmanmwcfkrptrooywzvopkrmlybyypnpnlpwmfustwamilbnwqtyhyapanfipunhadyhckzcfzlybeyzftrlzpabhqwmfwelzffbdiiclyayuqlkgcnfmqypltyyjlvqmnfqbhqdcejotaaipnprzplccifybqyipangbymefxzcvfppvfikeihdlfzqbrtuncpwmqyoyqrljzbrmqttqcqwmfjbciawbowvnbwtrxfdxnlxdbeyillrzxtbrypemyfbomscktbvpbywawozgrtjzqzifbcvplfacuowmrhzzvaufdanhzplrwxfaryqgwhmatadobcqrhkpagjbclhjlfzyucciawbwmfgbxmfgljmamnfqairdwanslqawrdxrospvgzxtzrpbyqeokuwhlildvwqzqeyzlzyucciawbymfnmlafyrwmrfipvrmqaifmbftryiwmaypexnmppcyybwtrurydnmqpmzjfcmqyocqrlbptyybwtrjbfbsufcmoflniiyzwmzjfcmolfeiahfbcrkrtbvyketngbcmgwlybvhrptnfrebryiwmcyrekbgjptnhdwmgyocmhnfwqfyodiamituvnbdtvgjpvfyfylhmqcqrxbdmguqdcacpnmgnbrcrlopvrmqaifffxqgyblcgyocqgifcmzuismhlbffqykzbeymlgfwbebrarpzeykpagjxdbeuknprymlzyuylbnciwmqycciawbnmgnbrcrlopmfnrymtobczrglylvuipbboqpayypqihnbdbbopwmflbeiexpewhnbdtrmpzcszolvpypymzjbnprhqaifkrttlualvffryqiyodbbopwmfgljmamkpkrmplqeypawhlbnznmbccadlfzaippvayjtasirozbsbdihdlfzqbrtxnlilnblzpurwxyqdobywhmmzcellyaiufykeyalvffxgmacoaieokpnblzpurwxyqdobdccyotmhlbwmqypeqaxrxwaxbpagfxxwvabymeuiomturwtruzecrfipurhqltbhacmfdfydvnbwmficqqpcbcarnipafiioigmcciawxtadofdmgllfdrhqpvgyocqgifcmolfeiahfbcrirbcvpfpvqlxtmanxdggllfdrlxgmpfbfzfuoxmfirdiamipcemxcurmgtvicqptrmfyorhfpcembetrmlfdecbcafjbnqnffdbrmapavhafaglfpaquoxmzykeyhcppbeirgmanbybrlotbbcopjecqlvacnfmbonfqicbyleufpvgupjbeirgmeuppurnqcmrholxcioeiiyzxwvkrzqdofwielfgmyucwizgbomyuopavmqlvpycciawxtarhbowvnmlafyqpqaxopmghbdmgyfyleumlaqyjlqawlxururuwhlascvdbaiefbcivuilznxfzlrflyleyp</code></pre>
<p>On d&#233;chiffre le message :</p>
<pre class="nohighlight"><code>leschefsquidepuisdenombreusesanneessontalatetedesarmeesfrancaisesontformeungouvernementcegouvernementalleguantladefaitedenosarmeessestmisenrapportaveclennemipourcesserlecombatafficheayantsuivilappeldujuinafficheplacardeeaulendemaindelappeldujuinlafficheatouslesfrancaisplacardeesurlesmursdelondrescertesnousavonsetenoussommessubmergesparlaforcemecaniqueterrestreetaeriennedelennemiinfinimentplusqueleurnombrecesontlescharslesavionslatactiquedesallemandsquinousfontreculercesontlescharslesavionslatactiquedesallemandsquiontsurprisnoschefsaupointdelesamenerlaouilsensontaujourdhuimaislederniermotestilditlesperancedoitelledisparastreladefaiteestelledefinitivenoncroyezmoimoiquivousparleenconnaissancedecauseetvousdisqueriennestperdupourlafrancelesmemesmoyensquinousontvaincuspeuventfairevenirunjourlavictoirecarlafrancenestpasseuleellenestpasseuleellenestpasseuleelleaunvasteempirederriereelleellepeutfaireblocaveclempirebritanniquequitientlameretcontinuelalutteellepeutcommelangleterreutilisersanslimiteslimmenseindustriedesetatsuniscetteguerrenestpaslimiteeauterritoiremalheureuxdenotrepayscetteguerrenestpastrancheeparlabatailledefrancecetteguerreestuneguerremondialetouteslesfautestouslesretardstouteslessouffrancesnempechentpasquilyadansluniverstouslesmoyensnecessairespourecraserunjournosennemisfoudroyesaujourdhuiparlaforcemecaniquenouspourronsvaincredanslavenirparuneforcemecaniquesuperieureledestindumondeestlamoigeneraldegaulleactuellementalondresjinvitelesofficiersetlessoldatsfrancaisquisetrouvententerritoirebritanniqueouquiviendraientasytrouveravecleursarmesousansleursarmesjinvitelesingenieursetlesouvriersspecialistesdesindustriesdarmementquisetrouvententerritoirebritanniqueouquiviendraientasytrouverasemettreenrapportavecmoiquoiquilarrivelaflammedelaresistancefrancaisenedoitpasseteindreetneseteindrapasdemaincommeaujourdhuijeparleraialaradiodelondres</code></pre>
<p>On rajoute les majuscules, les accents, puis la ponctuation et notre texte apparait :</p>
<pre class="nohighlight"><code>Les chefs qui, depuis de nombreuses ann&#233;es, sont &#224; la t&#234;te des arm&#233;es fran&#231;aises, ont form&#233; un gouvernement.

Ce gouvernement, all&#233;guant la d&#233;faite de nos arm&#233;es, s&#39;est mis en rapport avec l&#39;ennemi pour cesser le combat.
 
Certes, nous avons &#233;t&#233;, nous sommes, submerg&#233;s par la force m&#233;canique, terrestre et a&#233;rienne, de l&#39;ennemi.

Infiniment plus que leur nombre, ce sont les chars, les avions, la tactique des Allemands qui nous font reculer. Ce sont les chars, les avions, la tactique des Allemands qui ont surpris nos chefs au point de les amener l&#224; o&#249; ils en sont aujourd&#39;hui.

Mais le dernier mot est-il dit ? L&#39;esp&#233;rance doit-elle dispara&#238;tre ? La d&#233;faite est-elle d&#233;finitive ? Non !

Croyez-moi, moi qui vous parle en connaissance de cause et vous dis que rien n&#39;est perdu pour la France. Les m&#234;mes moyens qui nous ont vaincus peuvent faire venir un jour la victoire.

Car la France n&#39;est pas seule ! Elle n&#39;est pas seule ! Elle n&#39;est pas seule ! Elle a un vaste Empire derri&#232;re elle. Elle peut faire bloc avec l&#39;Empire britannique qui tient la mer et continue la lutte. Elle peut, comme l&#39;Angleterre, utiliser sans limites l&#39;immense industrie des Etats-Unis.

Cette guerre n&#39;est pas limit&#233;e au territoire malheureux de notre pays. Cette guerre n&#39;est pas tranch&#233;e par la bataille de France. Cette guerre est une guerre mondiale. Toutes les fautes, tous les retards, toutes les souffrances, n&#39;emp&#234;chent pas qu&#39;il y a, dans l&#39;univers, tous les moyens n&#233;cessaires pour &#233;craser un jour nos ennemis. Foudroy&#233;s aujourd&#39;hui par la force m&#233;canique, nous pourrons vaincre dans l&#39;avenir par une force m&#233;canique sup&#233;rieure. Le destin du monde est l&#224;.

Moi, G&#233;n&#233;ral de Gaulle, actuellement &#224; Londres, j&#39;invite les officiers et les soldats fran&#231;ais qui se trouvent en territoire britannique ou qui viendraient &#224; s&#39;y trouver, avec leurs armes ou sans leurs armes, j&#39;invite les ing&#233;nieurs et les ouvriers sp&#233;cialistes des industries d&#39;armement qui se trouvent en territoire britannique ou qui viendraient &#224; s&#39;y trouver, &#224; se mettre en rapport avec moi.

Quoi qu&#39;il arrive, la flamme de la r&#233;sistance fran&#231;aise ne doit pas s&#39;&#233;teindre et ne s&#39;&#233;teindra pas.

Demain, comme aujourd&#39;hui, je parlerai &#224; la Radio de Londres.</code></pre>
<p><em>Ce message est le discours du G&#233;n&#233;ral de Gaulle prononc&#233; le 18 juin 1940.</em></p>
<h2 id="conclusion">Conclusion</h2>
<p>Le chiffre de Vigen&#232;re offre donc plus de s&#233;curit&#233; que le chiffre de C&#233;sar, gr&#226;ce &#224; une cl&#233; plus complexe. Cependant, ce dernier n'est pas infaillible, et il est assez facile de trouver la cl&#233; de chiffrement &#224; partir du simple texte chiffr&#233;. Cet algorithme n'est donc plus utilis&#233; depuis qu'il a &#233;t&#233; cass&#233;, mais il existe une am&#233;lioration &#224; ce syst&#232;me qui est techniquement incassable : le <a href="/algo/chiffrement/chiffre_vernam.html">chiffre de Vernam</a>.</p>
 
      <!-- ------------ -->

      <footer>
         <br>
         <hr>
         <p>Une question ? Une suggestion ? N'h&#233;sitez pas &#224; me <a href="/a_propos.html">contacter</a> pour me communiquer vos remarques.
         <br>
      </footer>

   </body>
</html>
